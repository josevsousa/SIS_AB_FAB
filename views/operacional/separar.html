{{extend 'dashboard.html'}}

<link rel="stylesheet" href="{{=URL('static','jquery-ui-1.11.4.custom/jquery-ui.css')}}">
<script src="{{=URL('static','jquery-ui-1.11.4.custom/jquery-ui.js')}}"></script>
<script>
  $(document).ready(function(){
    // // thema form
    // $('#no_table_Cliente').addClass('form-control');
    // $('.form_etapa-1 form input[type=submit]').removeClass('btn-primary').addClass('btn-success').val('Adicione os Itens');
    // $('.form_etapa-1').delay(100).fadeIn(300) //esconder a transicao no form

        $('#dataTable2').DataTable({
            // "scrollX": true,
            "order": [ 0, 'dec' ],
            "language": {
              "url": "{{=URL('static','js/tradutorTable.json')}}"
            }
            //"lengthMenu": [[25, 50, -1], [25, 50, "All"]] 
        });

        $('.cadastroFull').on('click', function(){
            var cod = $(this).parent().parent().children('td')[1].textContent
            var dataSolicitacao = $(this).parent().parent().children('td')[3].textContent
            $(location).attr('href',"pedido?cod="+cod+"&dataSolicitacao="+dataSolicitacao);//redireciona a pagina
        });



  });//fim do jquary.document
</script>


<style>
input[type="search"] {
    border: 1px solid #CCC5B9;
    border-radius: 3px;
    padding: 5px;
}select {
    background-color: #FFFCF5;
    padding: 4px;
    border-radius: 4px;
    border: 1px solid #CCC5B9;
    margin: 0 7px;
}
/*new logo*/
img#logo-new_theme{
    width: 101px !important;
    padding: 0px 6px !important;
    font-size: 18px !important; 
}
.sidebar .logo, .sidebar[data-background-color="white"] .logo, .off-canvas-sidebar .logo, .off-canvas-sidebar[data-background-color="white"] .logo {
    border-bottom: 1px solid rgba(102, 97, 91, 0.3);
    display: -webkit-box;
    margin: 0 auto;
    text-align: -webkit-center;
}
/*fim new logo*/
h3.tit_hist {
    padding-left: 14px;
}
div.tab-pane {
  padding: 15px;
}
    #dataTable tbody tr:hover{
        cursor: pointer;
    }   
    span.at{
        padding: 4px 8px;
        margin-left: 8px;
        border-radius:50%; 
        font-weight: 800;
        color: #fff;
    }
    span.atrazo_amarelo {
        background: #FFC107;
    }   
    span.atrazo_vermelho {
        background: #1FD826;
    }   
    span.atrazo_verde {
        background: #61F166;
    }
    span.qtdePendente{
        background: #F44336;
    }
    #minhaTabela .glyphicon-ok {
        margin-left: 11px;
        color: #0CF34C;
    }
    .fontVermelha{color:#F44336 !important;}
    .fontVerde{color:#03B709 !important;}
    .icon-container {
    width: 0px !important;
}


#dataTable_1 td {
    padding: 4px 12px !important;
}
#dataTable2 td {
    padding: 12px 12px !important;
}
.listar{cursor: pointer;}
span.ti-angle-double-right {
    margin: 0px 0px 0px 13px;
    color: #4CAF50;
}
</style>

<input type="text" id="transitory" name="transitory" style="display:none">
<!-- <a href="#" id="t">AQUIIII</a> -->

<div class="wrapper">
    <div class="sidebar" data-background-color="white" data-active-color="danger">

    <!--
        Tip 1: you can change the color of the sidebar's background using: data-background-color="white | black"
        Tip 2: you can change the color of the active button using the data-active-color="primary | info | success | warning | danger"
    -->

        <div class="sidebar-wrapper">
            <div class="logo">
                <a href="http://www.creative-tim.com" class="simple-text">
                    {{=response.logo.new_theme}}
                </a>
            </div>
            {{=response.barraL}}
        </div>
    </div>






    <div class="main-panel">
        <div id="aviso" style='display:none' class="alert alert-warning alert-with-icon" data-notify="container"></div>
        <nav class="navbar navbar-default">
            <div class="container-fluid">

                <div class="navbar-header">
                    <button type="button" class="navbar-toggle">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar bar1"></span>
                        <span class="icon-bar bar2"></span>
                        <span class="icon-bar bar3"></span>
                    </button>
                    
                    <h3 class="tit_hist">Separando itens dos pedidos</h3>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                         <li class="dropdown">
                              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    <i class="ti-bell"></i>
                                    <p class="notification">5</p>
                                    <p>Alertas</p>
                                    <b class="caret"></b>
                              </a>
                              <ul class="dropdown-menu">
                                <li><a href="#">Notification 1</a></li>
                                <li><a href="#">Notification 2</a></li>
                                <li><a href="#">Notification 3</a></li>
                                <li><a href="#">Notification 4</a></li>
                                <li><a href="#">Another notification</a></li>
                              </ul>
                        </li>
                        <!-- <li>
                            <a href="#">
                                <i class="ti-settings"></i>
                                <p>Settings</p>
                            </a>
                        </li> -->
                    </ul>

                </div>
            </div>
        </nav>


        <div class="content">
            <div class="container-fluid">
                <div class="row">
<!-- ==================================================================== -->
<div class="col-lg-12 col-md-12">
    <!-- card -->
    <div class="card">
        <div class="header">
            <h4 class="title">Pedidos tratados no operacional</h4>
            <p class="category">Pedidos em processo de separação dos itens</p>
        </div>
        <!-- content X-->
        <div class="content content-full-width">
            <ul role="tablist" class="nav nav-tabs">
                <li role="presentation" class="active">
                    <a href="#icon-info" data-toggle="tab"><i class="fa fa-info"></i> Pendentes</a>
                </li>
                <li>
                    <a href="#icon-account" data-toggle="tab"><i class="fa fa-user"></i> Separado &amp; Embalado</a>
                </li>
            </ul>
            <!-- fim tabContent A -->
            <div class="tab-content">
                <div id="icon-info" class="tab-pane active">
                    <table id="dataTable_1" class="table first">
                      <thead>
                            <tr>
                                <th style="display:none"></th>
                                <th>Codigo Pedido</th>
                                <th>CLiente</th>
                                <th>Data Solicitaçao</th>
                                <th>Status Itens</th>
                                <th>Pacotes</th>
                                <th></th>
                            </tr>
                      </thead>
                      <tbody>
                            {{from datetime import date}}
                                {{for pedido in pedidos:}}
                                    {{if (pedido.deletado != True):}}
                                        {{if (pedido.status_venda != 'OK') or ((pedido.volume == 0) or (pedido.volume == None)):}}  
                                            {{if pedido.status_venda != 'OK':}}   
                                                {{venda =  (pedido.dataVenda).strftime('%Y,%m,%d')
                                                venda = venda.split(',')
                                                atrazo = date.today() - date(int(venda[0]),int(venda[1]),int(venda[2]))
                                                
                                                if atrazo.days > 14:
                                                    atrazo = "<span class='at atrazo_vermelho'>%s</span>"%atrazo.days
                                                else:
                                                    atrazo = "<span class='at atrazo_amarelo'>%s</span>"%atrazo.days
                                                    pass    
                                                atrazo = XML(atrazo) }}
                                            {{else:}}   
                                            {{atrazo = XML("<span class='ti-angle-double-right'></span>")}}
                                            {{pass}}    
                                            
                                            <tr>
                                                <td style="display:none">{{=pedido.id}}</td>
                                                <td>{{=pedido.codigoVenda}}</td>
                                                <td>{{=db(Clientes.id == pedido.clienteEmail).select('nome')[0].nome}}</td>
                                                <td>{{=(pedido.dataVenda).strftime('%d/%m/%Y as %H:%M:%S')}}{{=atrazo}}</td>
                                                <td>{{=pedido.status_venda}}</td>
                                                {{if (pedido.volume != None) and (pedido.volume != 0):}}
                                                    <td id="volumePendente">
                                                        <span class="at atrazo_verde">{{=pedido.volume}}</span>
                                                    </td>

                                                {{else:}}
                                                    <td id="volumePendente">
                                                        <span class="at qtdePendente">0</span>
                                                    </td>
                                                {{pass}}
                                                
                                                <td>
                                                    <div class="icon-container listar cadastroFull">
                                                        <span class="ti-angle-right"></span><span class="icon-name"></span>
                                                    </div>
                                                </td>
                                            </tr>       
                                        {{pass}}

                                {{pass}}                 
                            {{pass}}<!--FIM FOR PEDIDOS-->
                        </tbody>
                    </table>
                </div>
                <!-- separados -->                    
                <div id="icon-account" class="tab-pane">
                    <table id="dataTable2" class="table table-striped hover" cellspacing="0" width="100%" >
                        <thead>
                            <tr>
                                <th style="display:none"></th>
                                <th>Codigo Pedido</th>
                                <th>CLiente</th>
                                <th>Data Solicitaçao</th>
                                <th>Pacotes</th>
                            </tr>
                            <tbody>
                                {{from datetime import date}}
                                {{for pedido in pedidos:}}<!--FOR PEDIDOS-->
                                    {{if (pedido.deletado != True):}}<!-- IF PEDIDOS.DELETADOS-->
                                        {{if (pedido.status_venda == 'OK') and ((pedido.volume != 0) and (pedido.volume != None)):}}  
                                            
                                            <tr>
                                                <td style="display:none">{{=pedido.id}}</td>
                                                <td>{{=pedido.codigoVenda}}</td>
                                                <td>{{=db(Clientes.id == pedido.clienteEmail).select('nome')[0].nome}}</td>
                                                <td>{{=(pedido.dataVenda).strftime('%d/%m/%Y as %H:%M:%S')}}</td>
                                                {{if (pedido.volume != None) and (pedido.volume != 0):}}
                                                    <td id="volumePendente">
                                                        <span class="at atrazo_verde">{{=pedido.volume}}</span>
                                                    </td>
                                                {{else:}}
                                                    <td id="volumePendente">
                                                        <span class="at qtdePendente">0</span>
                                                    </td>
                                                {{pass}}
                                            </tr>       
                                        {{pass}}
                                    {{pass}}<!--FIM IF PEDIDOS.DELETADOS-->                 
                                {{pass}}<!--FIM FOR PEDIDOS-->
                            </tbody>
                        </thead>
                    </table><!-- FIM TABELA PENDENTE -->
                </div><!-- fim separados -->
            </div><!-- fim tabContent A -->
        </div><!-- fim do content X-->
    </div><!-- fim do card -->
</div><!--fim do col-12-->    
<!-- ==================================================================== -->
                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="container-fluid">
                <nav class="pull-left">
                    <ul>

                        <li>
                            <a href="http://www.creative-tim.com">
                                Creative Tim
                            </a>
                        </li>
                        <li>
                            <a href="http://blog.creative-tim.com">
                               Blog
                            </a>
                        </li>
                        <li>
                            <a href="http://www.creative-tim.com/license">
                                Licenses
                            </a>
                        </li>
                    </ul>
                </nav>
                <div class="copyright pull-right">
                    &copy; <script>document.write(new Date().getFullYear())</script>, made with <i class="fa fa-heart heart"></i> by <a href="http://www.creative-tim.com">Creative Tim</a>
                </div>
            </div>
        </footer>


    </div>
</div>